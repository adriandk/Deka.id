package com.adrian.dekaid.data

import androidx.arch.core.executor.testing.InstantTaskExecutorRule
import com.adrian.dekaid.utils.DataDummy
import com.adrian.dekaid.utils.LiveDataTest
import org.junit.Assert.*
import org.junit.Rule
import org.junit.Test
import org.junit.runner.RunWith
import org.mockito.junit.MockitoJUnitRunner

@RunWith(MockitoJUnitRunner::class)
class MovieRepositoryTest {

    private val movieRepository = FakeMovieRepository()
    private val movieResponse = DataDummy.getRemoteMovie()
    private val movieId = movieResponse[0].id
    private val showResponse = DataDummy.getRemoteShow()
    private val showId = showResponse[0].id

    @get:Rule
    var instantTaskExecutorRule = InstantTaskExecutorRule()

    @Test
    fun loadAllMovies() {
        val movieData = LiveDataTest.getValue(movieRepository.loadAllMovies())
        assertNotNull(movieData)
        assertNotEquals(movieData.size, movieResponse.size)
    }

    @Test
    fun loadAllShow() {
        val showData = LiveDataTest.getValue(movieRepository.loadAllShow())
        assertNotNull(showData)
        assertNotEquals(showData.size, showResponse.size)
    }

    @Test
    fun loadDetailMovies() {
        val movieDetailData = LiveDataTest.getValue(movieRepository.loadDetailMovies(movieId))
        assertNotNull(movieDetailData)
        assertEquals(movieDetailData.movieId, movieId)
    }

    @Test
    fun loadDetailShow() {
        val showDetailData = LiveDataTest.getValue(movieRepository.loadDetailShow(showId))
        assertNotNull(showDetailData)
        assertEquals(showDetailData.movieId, showId)
    }
}